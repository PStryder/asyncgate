# AsyncGate Environment Configuration
# Copy this file to .env and customize for your environment

# ============================================================================
# General
# ============================================================================
ASYNCGATE_ENV=development
# Options: development, staging, production

ASYNCGATE_INSTANCE_ID=asyncgate-1
# Auto-detected if not set

ASYNCGATE_LOG_LEVEL=INFO
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL

ASYNCGATE_DEBUG=false


# ============================================================================
# Database
# ============================================================================
ASYNCGATE_DATABASE_URL=postgresql+asyncpg://asyncgate:asyncgate@localhost:5432/asyncgate


# ============================================================================
# Security (P0.3 - CORS Configuration)
# ============================================================================
# CORS Allowed Origins (comma-separated, NO WILDCARDS with credentials)
# P0.3 FIX: Explicit allowlist prevents CSRF attacks
ASYNCGATE_CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080,https://yourapp.com

# CORS Settings
ASYNCGATE_CORS_ALLOW_CREDENTIALS=true
ASYNCGATE_CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
ASYNCGATE_CORS_ALLOWED_HEADERS=Authorization,Content-Type,X-Tenant-ID


# ============================================================================
# Authentication
# ============================================================================
# API Key (required in staging/production)
ASYNCGATE_API_KEY=your-secret-api-key-here

# Allow insecure dev mode (ONLY for development)
ASYNCGATE_ALLOW_INSECURE_DEV=false


# ============================================================================
# Rate Limiting (P0.4 - Enabled by Default)
# ============================================================================
# P0.4 FIX: Rate limiting now ON by default (forced in staging/production)
ASYNCGATE_RATE_LIMIT_ENABLED=true

# Rate limit backend (memory or redis)
ASYNCGATE_RATE_LIMIT_BACKEND=memory

# Rate limit defaults (100 calls per 60 seconds)
ASYNCGATE_RATE_LIMIT_DEFAULT_CALLS=100
ASYNCGATE_RATE_LIMIT_DEFAULT_WINDOW_SECONDS=60

# Redis URL (required if using redis backend)
# ASYNCGATE_REDIS_URL=redis://localhost:6379/0


# ============================================================================
# Lease Configuration
# ============================================================================
ASYNCGATE_DEFAULT_LEASE_TTL_SECONDS=120
ASYNCGATE_MAX_LEASE_TTL_SECONDS=1800
ASYNCGATE_LEASE_SWEEP_INTERVAL_SECONDS=5


# ============================================================================
# Task Configuration
# ============================================================================
ASYNCGATE_DEFAULT_MAX_ATTEMPTS=2
ASYNCGATE_DEFAULT_RETRY_BACKOFF_SECONDS=15
ASYNCGATE_MAX_RETRY_BACKOFF_SECONDS=900


# ============================================================================
# Receipt Mode
# ============================================================================
ASYNCGATE_RECEIPT_MODE=standalone
# Options: standalone, memorygate_integrated

# MemoryGate integration (if using memorygate_integrated mode)
# ASYNCGATE_MEMORYGATE_URL=https://memorygate.fly.dev
# ASYNCGATE_MEMORYGATE_TOKEN=your-token
# ASYNCGATE_MEMORYGATE_TENANT_ID=your-tenant-id


# ============================================================================
# Server
# ============================================================================
ASYNCGATE_HOST=0.0.0.0
ASYNCGATE_PORT=8080
